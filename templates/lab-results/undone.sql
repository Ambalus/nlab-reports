SELECT DISTINCT S.CODE
              , S.TEXT
              , lr.CANCEL_STATUS AS STATUS
FROM SERV_TEST ST
   , TEST_RESULT TR
   , SERV S
   ,lab_research lr
WHERE TR.LAB_SAMPLE_ID = :sampleId
  AND lr.lab_sample_id = :sampleId
  AND lr.serv_id = s.id
  AND TR.LAB_TEST_ID = ST.TEST_ID
  AND TR.SUPPRESS_STATUS = 0
  AND (TR.OPTIONAL_STATUS = 0
    OR (TR.OPTIONAL_STATUS = 1 AND TR.VALUE IS NOT NULL))
  AND ST.SERV_ID = S.ID
GROUP BY S.ID, S.CODE, S.TEXT, lr.CANCEL_STATUS
HAVING MIN (TR.VALIDATION_STATUS) = 0